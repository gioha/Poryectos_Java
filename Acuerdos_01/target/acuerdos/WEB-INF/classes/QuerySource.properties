#---------------------------------------------------------------------------------
# 							            QUERYS
#
# Contiene los querys que se utilizaran en cada modulo o de manera general
# 
# Nomenclatura query: query_"modulo al que pertenece"_"nombre del query"
#
# Ejemplo: query_administracionUsuarios_todo = Select * FROM usuarios..
#---------------------------------------------------------------------------------


query_admonIndicadoresAnio_indicadoresDisponiblesRecurrentes 				= SELECT * FROM (SELECT row_.*, rownum rownum_ FROM (SELECT idIndicador, idProceso, idSubProceso, "nombre" as nombre, "proceso.etiqueta" as procesoEtiqueta, "subProceso.etiqueta" as subProcesoEtiqueta, "nivelPrivacidad.etiqueta" as nivelPrivacidadEtiqueta, habilitado FROM ( SELECT idIndicador, idProceso, idSubProceso, nombre as "nombre", procesoEtiqueta as "proceso.etiqueta", subProcesoEtiqueta as "subProceso.etiqueta", nivelPrivacidadEtiqueta as "nivelPrivacidad.etiqueta", habilitado FROM ( SELECT COUNT(ANIO) AS TOTAL, INA.ID_INDICADOR AS idIndicador, INA.PROCESO AS idProceso, INA.SUBPROCESO AS idSubProceso, IND.NOMBRE, PRO.ETIQUETA AS procesoEtiqueta, SUB.ETIQUETA AS subProcesoEtiqueta, NP.ETIQUETA AS nivelPrivacidadEtiqueta, ind.habilitado as habilitado FROM PROCESOS PRO, C_NIVELES_PRIVACIDAD NP, INDICADORES IND, INDICADORES_ANIO INA LEFT OUTER JOIN SUBPROCESOS SUB ON INA.SUBPROCESO = SUB.ID_SUBPROCESO AND INA.PROCESO = SUB.ID_PROCESO WHERE ANIO <> :anioConfiguracion AND INA.PROCESO = PRO.ID_PROCESO AND IND.ID_INDICADOR = INA.ID_INDICADOR AND IND.NIVEL_PRIVACIDAD = NP.ID_PRIVACIDAD GROUP BY INA.ID_INDICADOR, IND.NOMBRE, INA.PROCESO, INA.SUBPROCESO, PRO.ETIQUETA, SUB.ETIQUETA, NP.ETIQUETA, ind.habilitado ) WHERE TOTAL > 1 ) <filtroColumna> <order> ) row_ WHERE rownum <= :maxRows ) WHERE rownum_ > :minRows
#--------------------------------------Consultas a GEOGRAFICOINE -----------------------------------------------------
query.codigosql.localidadesPorMunicipio=select id_localidad,nombre_localidad from geograficoine.localidades where id_estado=:idEstado and id_municipio=:idMunicipio and id_corte=:idCorte order by nombre_localidad
query.codigosql.localidadesPorSeccion=select l.id_localidad,l.nombre_localidad from geograficoine.localidades l inner join geograficoine.secciones_localidades sl on l.id_estado=sl.id_estado and l.id_localidad=sl.id_localidad and l.id_corte=sl.id_corte and l.id_municipio=sl.id_municipio where sl.id_estado=:idEstado and sl.seccion=:seccion and sl.id_corte=:idCorte order by l.nombre_localidad
query.codigosql.seccionesPorLocalidadMun=select s.seccion,s.tipo from geograficoine.secciones s inner join geograficoine.secciones_localidades sl on sl.id_estado=s.id_estado and sl.seccion=s.seccion and sl.id_corte=s.id_corte where sl.id_estado=:idEstado  and sl.id_corte=:idCorte  and sl.id_localidad=:idLocalidad and sl.id_municipio=:idMunicipio
query.codigosql.seccionesPorDistritoFed=select seccion,tipo from geograficoine.secciones where id_estado=:idEstado and id_distrito_federal=:idDistrito and id_corte=:idCorte order by seccion
query.codigosql.seccionesPorDistritoLoc=select seccion,tipo from geograficoine.secciones where id_estado=:idEstado and id_distrito_local=:idDistrito and id_corte=:idCorte order by seccion
query.codigosql.seccionesPorMunicipio=SELECT seccion,tipo FROM geograficoine.secciones WHERE id_estado        =:idEstado AND id_municipio=:idMunicipio AND id_corte           =:idCorte ORDER BY seccion
query.codigosql.municipioPorSeccion=select m.id_municipio,m.nombre_municipio from geograficoine.municipios m inner join geograficoine.secciones s on m.id_estado=s.id_estado and m.id_municipio=s.id_municipio where s.id_estado=:idEstado and s.seccion=:seccion and s.id_corte=:idCorte
query.codigosql.localidadPorId=select id_localidad,nombre_localidad from geograficoine.localidades where id_estado=:idEstado and id_localidad=:idLocalidad and id_corte=:corte and id_municipio=:idMunicipio


query.codigosql.distritoPorSeccionLocal=SELECT DISTINCT dl.id_distrito_local,   dl.CABECERA_DISTRITAL_LOCAL FROM geograficoine.SECCIONES s INNER JOIN geograficoine.distritos_locales dl ON s.id_distrito_local         = dl.id_distrito_local  AND s.id_estado        = dl.id_estado AND s.id_corte         = dl.id_corte WHERE s.id_estado      = :idEstado AND s.seccion= :seccion AND s.id_corte         = :idCorte
query.codigosql.distritoPorSeccionFederal=SELECT DISTINCT dl.id_distrito_federal,   dl.CABECERA_DISTRITAL_FEDERAL FROM geograficoine.SECCIONES s INNER JOIN geograficoine.distritos_Federales dl ON s.id_distrito_federal         = dl.id_distrito_federal  AND s.id_estado        = dl.id_estado AND s.id_corte         = dl.id_corte WHERE s.id_estado      = :idEstado AND s.seccion = :seccion AND s.id_corte         = :idCorte


#--------------------------------------------------------------------------------------
# QUERY PARA REGISTRO DE ACUERDOS
#--------------------------------------------------------------------------------------
query.elimina.seguimientocg  = delete from seguimientos_cg where ID_NUM_ACUERDO = :IDACUERDO1
query.elimina.puntosacuerdo  = delete from puntos_acuerdo where ID_NUM_ACUERDO = :IDACUERDO

#--------------------------------------------------------------------------------------
# QUERY PARA REGISTRO DE ACUERDOS
#--------------------------------------------------------------------------------------
query.elimina.clasificacion  = delete from c_clasificaciones where ID_CLASIFICACION = :IDCLASIFICACION


#-------------------------------------------------------------------------------------
#								QUERYS PARA LOS REPORTES
#-------------------------------------------------------------------------------------
query.reporte.seguimiento.inicial= Select a.ID_NUM_ACUERDO, pa.NUMERALIA_TEXTO, a.FECHA_EMISION, DECODE(a.estatus, 0, 'EN PROCESO', 1, 'COMPLETADO') AS ESTATUS, careas.DESCRIPCION as area, clasi.DESCRIPCION, TO_CHAR(a.FECHA_EMISION,'YYYY') as anio from acuerdos a inner join puntos_acuerdo pa on pa.id_num_acuerdo = a.ID_NUM_ACUERDO inner join c_clasificaciones clasi on pa.ID_CLASIFICACION = clasi.ID_CLASIFICACION left outer join seguimientos_cg scg on scg.ID_NUM_ACUERDO = pa.ID_NUM_ACUERDO left outer join c_areas careas on careas.ID_AREA = scg.ID_AREA where  a.activo =1 and pa.activo = 1 and ROWNUM < 201 Order by a.FECHA_EMISION asc
query.reporte.seguimiento.fecha= select a.id_num_acuerdo, a.NOMBRE nombre_acuerdo, ssg2.ID_ESTATUS_PUNTO, ssg2.texto_punto, ssg2.numeralia, ssg2.numeralia_texto, ssg2.id_clasificacion, ssg2.fecha_movimiento, ssg2.anio, cclasi.DESCRIPCION clasificacion, careas.descripcion areas, CASE cep.ID_ESTATUS_PUNTO WHEN 1 THEN 'Pendiente' WHEN 7 THEN 'Cumplido' ELSE 'En proceso' END estatus, careas.siglas, cts.descripcion as tipo_sesion, a.fecha_emision from acuerdos a inner join(   select  SSG.ID_ESTATUS_PUNTO,   pa.ID_NUM_ACUERDO,   pa.TEXTO_PUNTO,   pa.NUMERALIA,  pa.NUMERALIA_TEXTO,   pa.ID_CLASIFICACION,   ssg.FECHA_MOVIMIENTO,   TO_CHAR(ssg.FECHA_MOVIMIENTO,'YYYY')   as anio, ssg.AREA from PUNTOS_ACUERDO pa inner join(  SELECT  SG.ID_ESTATUS_PUNTO, SG.ID_AREA AS AREA,  sg.ID_NUM_ACUERDO, SG.ID_AREA,  SG.FECHA_MOVIMIENTO, sg.numeralia FROM SEGUIMIENTOS_CG SG INNER JOIN( select                       ID_NUM_ACUERDO, ID_AREA, MAX(FECHA_MOVIMIENTO) AS FECHA_MOVIMIENTO from seguimientos_CG  where FECHA_MOVIMIENTO between to_date (:fechaIn, 'yyyy/mm/dd') and to_date (:fechaFin, 'yyyy/mm/dd') GROUP BY ID_NUM_ACUERDO, ID_AREA ) ADENTRO ON ADENTRO.ID_NUM_ACUERDO =  SG.ID_NUM_ACUERDO AND ADENTRO.ID_AREA = SG.ID_AREA AND ADENTRO.FECHA_MOVIMIENTO = SG.FECHA_MOVIMIENTO ) ssg on ssg.ID_NUM_ACUERDO = pa.ID_NUM_ACUERDO and ssg.numeralia = pa.NUMERALIA ) ssg2 on ssg2.ID_NUM_ACUERDO = a.ID_NUM_ACUERDO inner join c_clasificaciones cclasi on cclasi.ID_CLASIFICACION = ssg2.id_clasificacion inner join c_areas careas on careas.id_area = ssg2.AREA inner join c_estatus_puntos cep on cep.ID_ESTATUS_PUNTO = ssg2.ID_ESTATUS_PUNTO inner join c_tipo_sesiones cts on cts.ID_TIPO_SESION = a.ID_TIPO_SESION and a.activo = 1  order by a.FECHA_EMISION DESC, a.ID_TIPO_SESION, a.ID_NUM_ACUERDO, ssg2.numeralia, careas.siglas asc


query.tipo.reporte.anio = SELECT CTD.TIPO, CTD.ID_TIPO_DOCUMENTO FROM ACUERDOS A INNER JOIN  C_TIPO_DOCUMENTOS CTD ON A.ID_TIPO_DOCUMENTO = CTD.ID_TIPO_DOCUMENTO inner join ( select acu.id_num_acuerdo from acuerdos acu inner join( select scg.id_num_acuerdo from SEGUIMIENTOS_CG scg group by                scg.id_num_acuerdo  ) scfg on scfg.id_num_acuerdo = acu.id_num_acuerdo  where acu.fecha_emision between to_date(:fechaIn, 'yyyy/mm/dd') and to_date (:fechaFin, 'yyyy/mm/dd') group by acu.id_num_acuerdo ) scg     on scg.id_num_acuerdo = A.ID_NUM_ACUERDO  where a.activo = 1     GROUP BY CTD.TIPO, CTD.ID_TIPO_DOCUMENTO 
#query.reporte.lista.anios = select distinct to_char(a.FECHA_EMISION, 'YYYY') as anio from acuerdos a inner join puntos_acuerdo  pa on pa.ID_NUM_ACUERDO = a.ID_NUM_ACUERDO 
query.reporte.lista.anios = select distinct to_char(a.FECHA_EMISION, 'YYYY') as anio from acuerdos a  inner join puntos_acuerdo  pa on pa.ID_NUM_ACUERDO = a.ID_NUM_ACUERDO inner join seguimientos_cg scg on scg.id_num_acuerdo = pa.id_num_acuerdo where a.activo = 1 order by anio desc
query.reporte.lista.anios.area = select  distinct to_char(a.FECHA_EMISION, 'YYYY') as anio from acuerdos a inner join puntos_acuerdo  pa on pa.ID_NUM_ACUERDO = a.ID_NUM_ACUERDO inner join seguimientos_cg scg on scg.id_num_acuerdo = pa.id_num_acuerdo where a.activo = 1 and scg.id_area= :area  order by anio desc
query.reporte.seguimiento.fecha.documento.area = select  a.id_num_acuerdo,           a.NOMBRE nombre_acuerdo,           ssg2.ID_ESTATUS_PUNTO,           ssg2.texto_punto,           ssg2.numeralia,           ssg2.numeralia_texto,           ssg2.id_clasificacion,           ssg2.fecha_movimiento,          ssg2.anio,           cclasi.DESCRIPCION clasificacion,           careas.descripcion areas,           CASE cep.ID_ESTATUS_PUNTO WHEN 1 THEN 'Pendiente' WHEN 7 THEN 'Cumplido' ELSE 'En proceso' END estatus,           careas.siglas,           a.id_tipo_documento,           ctd.tipo,           careas.ID_AREA,           a.ID_TIPO_SESION,           CTS.DESCRIPCION as tipo_Sesion,           TO_CHAR(a.FECHA_EMISION,           'yyyy-mm-dd')  from           acuerdos a  inner join ( select SSG.ID_ESTATUS_PUNTO, pa.ID_NUM_ACUERDO, pa.TEXTO_PUNTO, pa.NUMERALIA, pa.NUMERALIA_TEXTO, pa.ID_CLASIFICACION, ssg.FECHA_MOVIMIENTO, TO_CHAR(ssg.FECHA_MOVIMIENTO, 'YYYY') as anio, ssg.AREA from PUNTOS_ACUERDO pa inner join  ( SELECT SG.ID_ESTATUS_PUNTO, SG.ID_AREA AS AREA, sg.ID_NUM_ACUERDO, SG.ID_AREA, SG.FECHA_MOVIMIENTO, sg.numeralia  FROM SEGUIMIENTOS_CG SG INNER JOIN ( select ID_NUM_ACUERDO, ID_AREA, numeralia,  MAX(FECHA_MOVIMIENTO) AS FECHA_MOVIMIENTO  from                          seguimientos_CG where id_area = :area GROUP BY                   ID_NUM_ACUERDO,                           ID_AREA,                             numeralia              ) ADENTRO       ON ADENTRO.ID_NUM_ACUERDO =  SG.ID_NUM_ACUERDO  AND ADENTRO.ID_AREA = SG.ID_AREA AND ADENTRO.FECHA_MOVIMIENTO = SG.FECHA_MOVIMIENTO ) ssg on ssg.ID_NUM_ACUERDO = pa.ID_NUM_ACUERDO and ssg.numeralia = pa.NUMERALIA where pa.activo = 1 )ssg2 on ssg2.ID_NUM_ACUERDO = a.ID_NUM_ACUERDO  inner join c_clasificaciones cclasi  on cclasi.ID_CLASIFICACION = ssg2.id_clasificacion inner join c_areas careas  on careas.id_area = ssg2.AREA inner join c_estatus_puntos cep on cep.ID_ESTATUS_PUNTO = ssg2.ID_ESTATUS_PUNTO                     and a.activo = 1 inner join   C_TIPO_DOCUMENTOS ctd  on ctd.ID_TIPO_DOCUMENTO = a.id_tipo_documento inner join C_TIPO_SESIONES CTS ON CTS.ID_TIPO_SESION = a.ID_TIPO_SESION where a.ID_TIPO_DOCUMENTO = :documento and fecha_emision between to_date(:fechaIn, 'yyyy/mm/dd') and to_date (:fechaFin, 'yyyy/mm/dd') ORDER BY a.FECHA_EMISION DESC, a.ID_TIPO_SESION, a.ID_NUM_ACUERDO, ssg2.numeralia, careas.siglas asc
query.reporte.seguimiento.fecha.documento 	   = select  a.id_num_acuerdo,           a.NOMBRE nombre_acuerdo,           ssg2.ID_ESTATUS_PUNTO,           ssg2.texto_punto,           ssg2.numeralia,           ssg2.numeralia_texto,           ssg2.id_clasificacion,           ssg2.fecha_movimiento,          ssg2.anio,           cclasi.DESCRIPCION clasificacion,           careas.descripcion areas,           CASE cep.ID_ESTATUS_PUNTO WHEN 1 THEN 'Pendiente' WHEN 7 THEN 'Cumplido' ELSE 'En proceso' END estatus,           careas.siglas,           a.id_tipo_documento,           ctd.tipo,           careas.ID_AREA,           a.ID_TIPO_SESION,           CTS.DESCRIPCION as tipo_Sesion,           TO_CHAR(a.FECHA_EMISION,           'yyyy-mm-dd')  from           acuerdos a  inner join ( select SSG.ID_ESTATUS_PUNTO, pa.ID_NUM_ACUERDO, pa.TEXTO_PUNTO, pa.NUMERALIA, pa.NUMERALIA_TEXTO, pa.ID_CLASIFICACION, ssg.FECHA_MOVIMIENTO, TO_CHAR(ssg.FECHA_MOVIMIENTO, 'YYYY') as anio, ssg.AREA from PUNTOS_ACUERDO pa inner join  ( SELECT SG.ID_ESTATUS_PUNTO, SG.ID_AREA AS AREA, sg.ID_NUM_ACUERDO, SG.ID_AREA, SG.FECHA_MOVIMIENTO, sg.numeralia  FROM SEGUIMIENTOS_CG SG INNER JOIN ( select ID_NUM_ACUERDO, ID_AREA, numeralia,  MAX(FECHA_MOVIMIENTO) AS FECHA_MOVIMIENTO  from                          seguimientos_CG                       GROUP BY                   ID_NUM_ACUERDO,                           ID_AREA,                             numeralia              ) ADENTRO       ON ADENTRO.ID_NUM_ACUERDO =  SG.ID_NUM_ACUERDO  AND ADENTRO.ID_AREA = SG.ID_AREA AND ADENTRO.FECHA_MOVIMIENTO = SG.FECHA_MOVIMIENTO ) ssg on ssg.ID_NUM_ACUERDO = pa.ID_NUM_ACUERDO and ssg.numeralia = pa.NUMERALIA where pa.activo = 1 )ssg2 on ssg2.ID_NUM_ACUERDO = a.ID_NUM_ACUERDO  inner join c_clasificaciones cclasi  on cclasi.ID_CLASIFICACION = ssg2.id_clasificacion inner join c_areas careas  on careas.id_area = ssg2.AREA inner join c_estatus_puntos cep on cep.ID_ESTATUS_PUNTO = ssg2.ID_ESTATUS_PUNTO                     and a.activo = 1 inner join   C_TIPO_DOCUMENTOS ctd  on ctd.ID_TIPO_DOCUMENTO = a.id_tipo_documento inner join C_TIPO_SESIONES CTS ON CTS.ID_TIPO_SESION = a.ID_TIPO_SESION where a.ID_TIPO_DOCUMENTO = :documento and fecha_emision between to_date(:fechaIn, 'yyyy/mm/dd') and to_date (:fechaFin, 'yyyy/mm/dd') ORDER BY a.FECHA_EMISION DESC, a.ID_TIPO_SESION, a.ID_NUM_ACUERDO, ssg2.numeralia, careas.siglas asc
query.reporte.seguimiento.acuerdo.historico   = select scg.id_estatus_punto, cep.descripcion  tipo_mov, scg.descripcion, scg.ID_NUM_ACUERDO, scg.ID_AREA, scg.FECHA_MOVIMIENTO from seguimientos_CG  scg inner join c_estatus_puntos cep on cep.ID_ESTATUS_PUNTO =  scg.ID_ESTATUS_PUNTO where ID_NUM_ACUERDO = :acuerdo and id_area = :area and numeralia = :numeralia order by scg.FECHA_MOVIMIENTO desc
 
#-------------------------------------------------------------------------------------
#								QUERYS PARA CATÁLOGO DE USUARIOS
#-------------------------------------------------------------------------------------
query.compara.area.con.ldap =SELECT * FROM C_AREAS WHERE TRANSLATE(UPPER(DESCRIPCION), 'ÁÉÍÓÚ', 'AEIOU') = TRANSLATE(UPPER(:descTexto), 'ÁÉÍÓÚ', 'AEIOU')
query.areas.responsables.relacionados =SELECT DISTINCT C_AREAS.ID_AREA, C_AREAS.TIPO_AREA, C_AREAS.ID_ENTIDAD, C_AREAS.DESCRIPCION, C_AREAS.SIGLAS FROM C_AREAS JOIN RESPONSABLES_AREAS ON C_AREAS.ID_AREA = RESPONSABLES_AREAS.ID_AREA WHERE C_AREAS.TIPO_AREA = :tipoArea AND RESPONSABLES_AREAS.ESTATUS = 1 ORDER BY C_AREAS.DESCRIPCION

#-------------------------------------------------------------------------------------
#								QUERYS PARA EL MANEJO DE LOS MENUS CON LAS TABLAS ADMIN IMPORTADAS AL SISTEMA
#-------------------------------------------------------------------------------------

query.menu.admin = SELECT MESU.ID_SISTEMA, MESU.ID_MENU, MESU.DESCRIPCION_MENU, MESU.ID_SUBMENU, MESU.DESCIPCION_SUBMENU, M.ID_MODULO, M.TIPO_MODULO, M.NOMBRE_MODULO, M.ID_GRUPO, M.ID_ACCION, M.URL_MODULO FROM ( \
    			   SELECT M.ID_SISTEMA, M.ID_MENU, M.DESCRIPCION AS DESCRIPCION_MENU, S.ID_SUBMENU, S.DESCRIPCION AS DESCIPCION_SUBMENU FROM MENUS M RIGHT OUTER JOIN SUBMENUS S \
    			   ON M.ID_MENU = S.ID_MENU AND M.ID_SISTEMA = S.ID_SISTEMA ) MESU FULL OUTER JOIN ( \
    			   SELECT MAR.ID_SISTEMA, M.ID_MENU, ID_SUBMENU, MAR.ID_MODULO, M.TIPO_MODULO, M.NOMBRE_MODULO, MAR.ID_GRUPO, MAR.ID_ACCION, MAR.URL_MODULO FROM MODULOS M RIGHT OUTER JOIN ( \
        		   SELECT MA.ID_SISTEMA, MA.ID_MODULO, MA.ID_GRUPO, MA.ID_ACCION, UM.URL_MODULO FROM URLS_MODULOS UM RIGHT OUTER JOIN ( \
                   SELECT * FROM ACCIONES_PERMISOS WHERE ID_MODULO IN ( SELECT ID_MODULO FROM ESTATUS_MODULOS  WHERE ESTATUS LIKE 'A' AND ID_SISTEMA = :IDSISTEMA AND ID_GRUPO IN ( \
                   SELECT ID_GRUPO FROM GRUPOS_SISTEMAS WHERE GRUPOS LIKE :ROLUSER ) ) AND ID_SISTEMA = :IDSISTEMA AND ID_GRUPO IN ( \
                   SELECT ID_GRUPO FROM GRUPOS_SISTEMAS WHERE GRUPOS LIKE :ROLUSER ) ) MA ON UM.ID_SISTEMA =  MA.ID_SISTEMA AND UM.ID_MODULO = MA.ID_MODULO AND \
           		   UM.ID_ACCION = MA.ID_ACCION ) MAR ON M.ID_MODULO = MAR.ID_MODULO AND M.ID_SISTEMA = MAR.ID_SISTEMA ) M ON MESU.ID_SISTEMA = M.ID_SISTEMA AND MESU.ID_MENU = M.ID_MENU AND \
 	 			   MESU.ID_SUBMENU = M.ID_SUBMENU ORDER BY MESU.ID_MENU, MESU.ID_SUBMENU, M.ID_MODULO, M.ID_ACCION

